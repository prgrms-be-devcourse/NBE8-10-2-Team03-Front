# CONTRACT_API.md
# 프론트엔드 ↔ 백엔드 공통 API 계약 문서 (MVP 기준)

---

## 0. 적용 범위

- 본 문서는 MVP(2026-01-22까지) 구현 범위에 적용된다.
- 모든 프론트엔드 페이지 MD는 본 문서를 전제로 작성한다.
- 실시간(WebSocket, SSE, Polling)은 사용하지 않는다.
- 인증은 쿠키 기반으로 동작한다.

---

## 1. 공통 응답 포맷 (RsData)

모든 API 응답은 아래 구조로 반환된다.

```json
{
  "resultCode": "200-1",
  "msg": "성공 메시지",
  "data": {}
}
````

### 1.1 필드 정의

| 필드         | 타입         | 설명                  |
| ---------- | ---------- | ------------------- |
| resultCode | string     | 결과 코드 (`상태코드-세부번호`) |
| msg        | string     | 사용자에게 노출 가능한 메시지    |
| data       | any | null | 실제 응답 데이터           |

※ `statusCode` 필드는 서버 내부용이며 JSON 응답에 포함되지 않는다.

---

## 2. HTTP Status 결정 규칙

* HTTP 상태 코드는 `resultCode`의 앞자리 숫자로 결정된다.
* 컨트롤러의 반환 타입은 항상 `RsData<T>`이다.

### 예시

| resultCode | HTTP Status |
| ---------- | ----------- |
| 200-1      | 200         |
| 201-1      | 201         |
| 400-1      | 400         |
| 404-1      | 404         |
| 500-1      | 500         |

프론트엔드는 **HTTP status + resultCode를 함께 기준으로 처리**한다.

---

## 3. 성공 / 실패 판정 기준

### 3.1 성공

* HTTP Status: 2xx
* resultCode: `"200-*"` 또는 `"201-*"` 계열
* data: null일 수 있음

### 3.2 실패

* HTTP Status: 4xx / 5xx
* resultCode: `"400-*"` / `"404-*"` / `"500-*"` 계열
* msg 필드를 UI에 노출한다.

---

## 4. 에러 코드 규칙

### 4.1 공통 에러 코드

| resultCode | 의미             |
| ---------- | -------------- |
| 400-1      | 잘못된 요청 / 검증 실패 |
| 404-1      | 데이터 없음         |
| 500-*      | 서버 오류          |

---

## 5. 검증 에러 메시지 규칙 (중요)

### 5.1 400-1 에러 메시지 형식

검증 실패 시 `msg`는 여러 줄 문자열일 수 있다.

```text
field-code-message
field-code-message
```

예시:

```text
title-NotBlank-제목은 필수입니다
price-Min-가격은 0 이상이어야 합니다
```

### 5.2 프론트 처리 규칙

* `msg`에 `\n`이 있으면 줄 단위로 분리한다.
* 형식: `field-code-message`
* `field` 기준으로 각 입력 필드 아래에 메시지를 출력한다.
* 폼이 아닌 페이지에서는 첫 줄만 사용자에게 노출한다.

---

## 6. 인증 / 쿠키 전송 규칙

* 인증은 **쿠키 기반**으로 동작한다.
* 인증이 필요한 모든 API 요청은 **쿠키를 반드시 포함**해야 한다.

### 6.1 요청 옵션

#### fetch

```js
fetch(url, {
  credentials: "include"
});
```

#### axios

```js
axios.get(url, {
  withCredentials: true
});
```

---

## 7. CORS 전제 조건

* 허용 Origin:

  * [http://localhost:3000](http://localhost:3000)
  * [https://cdpn.io](https://cdpn.io)
* credentials 허용 상태

프론트엔드는 위 Origin 내에서 동작해야 한다.

---

## 8. 예외 처리 기본 UI 가이드

### 8.1 400-1

* 입력 오류 메시지 표시
* 폼 페이지: 필드별 에러
* 일반 페이지: alert 또는 toast

### 8.2 404-1

* “존재하지 않는 데이터” 안내 UI
* 뒤로가기 또는 목록 페이지 이동 버튼 제공

### 8.3 500 계열

* 공통 서버 오류 안내 메시지
* 재시도 또는 새로고침 안내

---

## 9. 페이지 MD와의 관계

* 모든 페이지 MD의 `5. API 연동` 섹션은 본 문서를 따른다.
* 페이지 MD에서는 **API별 세부 동작만 추가로 정의**한다.
* 공통 규칙은 본 문서를 재정의하지 않는다.

---

## 10. 변경 규칙

* 본 문서 변경 시:

  * 프론트 MD 전체에 영향
  * 프론트/백엔드 팀 공지 후 적용
