# AUTH_GUARD 공통 접근 제어 규칙

## 0. 목적
- 페이지 진입 시 사용자의 인증 상태에 따라 접근 가능 여부를 판단한다.
- 모든 페이지에서 동일한 기준을 사용하도록 접근 제어 로직을 공통화한다.
- 페이지 MD에 인증 분기 로직을 중복 작성하지 않기 위함이다.

---

## 1. 인증 상태 정의

### 1.1 로그인 상태
- 서버 인증 API 호출이 성공한 상태
- 쿠키 기반 인증이 유효한 상태
- 사용자 식별 정보 조회 가능

### 1.2 비로그인 상태
- 인증 API 호출 실패
- 인증 쿠키 없음 또는 만료
- 사용자 식별 정보 조회 불가

---

## 2. 인증 상태 판정 방식

### 2.1 판정 기준
- 프론트엔드는 토큰을 직접 관리하지 않는다.
- 로그인 상태 판정은 서버 응답으로만 결정한다.

### 2.2 판정 방법
- 인증 확인 API 호출
  - 예: GET /api/auth/me
- 또는
- 페이지 초기 데이터 API에서 사용자 정보 존재 여부 확인

### 2.3 요청 조건
- 모든 인증 확인 요청은 `credentials: include`를 사용한다.

---

## 3. 페이지 접근 유형 분류

모든 페이지는 아래 세 유형 중 하나로 분류한다.

### 3.1 공개 페이지 (Public)
- 로그인 여부와 관계없이 접근 가능
- 예:
  - 메인 페이지
  - 목록 조회 페이지

### 3.2 비로그인 전용 페이지 (Guest Only)
- 비로그인 사용자만 접근 가능
- 로그인 상태 접근 시 리다이렉트 처리
- 예:
  - 로그인 페이지
  - 회원가입 페이지

### 3.3 로그인 필수 페이지 (Protected)
- 로그인 사용자만 접근 가능
- 비로그인 접근 시 리다이렉트 처리
- 예:
  - 마이페이지
  - 글 작성 페이지
  - 채팅 페이지
  - 입찰/거래 관련 페이지

---

## 4. 접근 제어 규칙

### 4.1 비로그인 전용 페이지 규칙
- 대상: Guest Only 페이지
- 조건:
  - 로그인 상태 → 접근 불가
  - 비로그인 상태 → 접근 허용
- 처리:
  - 로그인 상태일 경우 메인 페이지(`/`)로 즉시 이동

---

### 4.2 로그인 필수 페이지 규칙
- 대상: Protected 페이지
- 조건:
  - 로그인 상태 → 접근 허용
  - 비로그인 상태 → 접근 불가
- 처리:
  - 비로그인 상태일 경우 로그인 페이지(`/login`)로 이동

---

### 4.3 공개 페이지 규칙
- 대상: Public 페이지
- 조건:
  - 로그인 여부 무관
- 처리:
  - 접근 제어 없음

---

## 5. 실행 시점

- 페이지 최초 진입
